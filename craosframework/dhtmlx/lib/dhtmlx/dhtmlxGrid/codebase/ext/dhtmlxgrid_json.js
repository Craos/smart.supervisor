/*
===================================================================
Copyright DHTMLX LTD. http://www.dhtmlx.com
This code is obfuscated and not allowed for any purposes except 
using on sites which belongs to DHTMLX LTD.

Please contact sales@dhtmlx.com to obtain necessary 
license for usage of dhtmlx components.
===================================================================
*/dhtmlXGridObject.prototype._process_json_row=function(a,b){a._attrs=b;for(var f=0;f<a.childNodes.length;f++)a.childNodes[f]._attrs={};if(b.userdata)for(var h in b.userdata)this.setUserData(a.idd,h,b.userdata[h]);for(var b=this._c_order?this.Xb(b.data):b.data,d=0;d<b.length;d++)if(typeof b[d]=="object"&&b[d]!=null){a.childNodes[d]._attrs=b[d];if(b[d].type)a.childNodes[d].zk=b[d].type;b[d]=b[d].value}this.VQ(a,b);return a};dhtmlXGridObject.prototype._process_js_row=function(a,b){a._attrs=b;for(var f=0;f<a.childNodes.length;f++)a.childNodes[f]._attrs={};if(b.userdata)for(var h in b.userdata)this.setUserData(a.idd,h,b.userdata[h]);for(var d=[],c=0;c<this.columnIds.length;c++){d[c]=b[this.columnIds[c]];if(typeof d[c]=="object"&&d[c]!=null){a.childNodes[c]._attrs=d[c];if(d[c].type)a.childNodes[c].zk=d[c].type;d[c]=d[c].value}!d[c]&&d[c]!==0&&(d[c]="")}this.VQ(a,d);return a};dhtmlXGridObject.prototype.updateFromJSON=function(a,b,f,h){typeof b=="undefined"&&(b= !0);this.cZ=[!0,b,f];this.load(a,h,"json")};dhtmlXGridObject.prototype._refreshFromJSON=function(a){this._f_rowsBuffer&&this.GF(0,"");reset= !1;if(window.eXcell_tree)eXcell_tree.prototype.Tw=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(a){var b=this.grid._h2.get[this.cell.parentNode.idd];b&&this.cell.parentNode.JT?this.setLabel(a):this.Tw(a)};var b=this.cellType.bP("tree"),f=a.parent||0,h={};this.cZ[2]&&(b!= -1?this._h2.so(f,function(a){h[a.id]= !0},this):this.forEachRow(function(a){h[a]= !0}));for(var d=a.rows,c=0;c<d.length;c++){var g=d[c],e=g.id;h[e]= !1;if(this.bj[e]&&this.bj[e].tagName!="TR")this._h2?this._h2.get[e].buff.data=g:this.aD[this.getRowIndex(e)].data=g,this.bj[e]=g;else if(this.bj[e])this._process_json_row(this.bj[e],g,-1),this.jQ(this.bj[e],!0);else if(this.cZ[1]){var l={idd:e,data:g,_parser:this._process_json_row,_locator:this._get_json_data},j=this.aD.length;this.cZ[1]=="top"?(this.aD.unshift(l),j=0):this.aD.push(l);if(this._h2)reset= !0,this._h2.add(e,f).buff=this.aD[this.aD.length-1];this.bj[e]=g;g=this.render_row(j);this._insertRowAt(g,j? -1:0)}}if(this.cZ[2])for(e in h)h[e]&&this.bj[e]&&this.deleteRow(e);this.cZ=null;if(window.eXcell_tree)eXcell_tree.prototype.setValue=eXcell_tree.prototype.Tw;reset&&this.uR();if(this._f_rowsBuffer)this._f_rowsBuffer=null,this.EJ()};dhtmlXGridObject.prototype._process_js=function(a){return this._process_json(a,"js")};dhtmlXGridObject.prototype._process_json=function(a,b){this._parsing= !0;try{if(a&&a.ai)eval("dhtmlx.temp="+a.ai.responseText+";"),a=dhtmlx.temp;else if(typeof a=="string")eval("dhtmlx.temp="+a+";"),a=dhtmlx.temp}catch(f){dhtmlxError.gn("LoadXML","Incorrect JSON",[a.ai||a,this]),a={rows:[]}}if(this.cZ)return this._refreshFromJSON(a);var h=parseInt(a.pos||0),d=parseInt(a.total_count||0),c= !1;d&&(this.aD[d-1]||(this.aD.length&&(c= !0),this.aD[d-1]=null),d<this.aD.length&&(this.aD.splice(d,this.aD.length-d),c= !0));for(var g in a)g!="rows"&&this.setUserData("",g,a[g]);if(b=="js"&&a.collections)for(var e in a.collections){var l=this.getColIndexById(e),j=a.collections[e];if(l!==window.undefined)if(this.cellType[l]=="clist"){colplaindata=[];for(var k=0;k<j.length;k++)colplaindata.push(j[k].label);this.AO(l,colplaindata)}else for(var o=this.cf(l),k=0;k<j.length;k++)o.eT(j[k].value,j[k].label)}if(this.gY())return this._process_tree_json(a,null,null,b);if(b=="js"){if(a.data)a=a.data;for(var i=0;i<a.length;i++)if(!this.aD[i+h]){var n=a[i],m=n.id||i+1;this.aD[i+h]={idd:m,data:n,_parser:this._process_js_row,_locator:this._get_js_data};this.bj[m]=a[i]}}else for(i=0;i<a.rows.length;i++)if(!this.aD[i+h])m=a.rows[i].id,this.aD[i+h]={idd:m,data:a.rows[i],_parser:this._process_json_row,_locator:this._get_json_data},this.bj[m]=a.rows[i];if(c&&this.ahK){var p=this.HF.scrollTop;this._reset_view();this.HF.scrollTop=p}else this.render_dataset();this._parsing= !1};dhtmlXGridObject.prototype._get_json_data=function(a,b){return typeof a.data[b]=="object"?a.data[b].value:a.data[b]};dhtmlXGridObject.prototype._process_tree_json=function(a,b,f,h){this._parsing= !0;var d= !1;if(!b){this.render_row=this.render_row_tree;d= !0;b=a;f=b.parent||0;f=="0"&&(f=0);if(!this._h2)this._h2=new dhtmlxHierarchy;if(this.aC)this.aC._h2=this._h2}if(h=="js"){if(b.data&& !f)a=b.data;if(b.rows)b=b.rows;for(var c=0;c<b.length;c++){var g=b[c].id,e=this._h2.add(g,f);e.buff={idd:g,data:b[c],_parser:this._process_js_row,_locator:this._get_js_data};if(b[c].open)e.state="minus";this.bj[g]=e.buff;this._process_tree_json(b[c],b[c],g,h)}}else if(b.rows)for(c=0;c<b.rows.length;c++){g=b.rows[c].id;e=this._h2.add(g,f);e.buff={idd:g,data:b.rows[c],_parser:this._process_json_row,_locator:this._get_json_data};if(b.rows[c].open)e.state="minus";this.bj[g]=e.buff;this._process_tree_json(b.rows[c],b.rows[c],g,h)}if(d)f!=0&&this._h2.JA(f,"state","minus"),this.cO(this._h2.get[f]),this._h2_to_buff(),f!=0&&(this.ahK||this.aW)?this.uR():this.render_dataset(),this.mI=== !1&&this.forEachRow(function(a){this.render_row_tree(0,a)}),this._parsing= !1};